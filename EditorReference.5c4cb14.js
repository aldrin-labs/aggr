import{m as e}from"./marked.esm.5c4cb14.js";import{e as n}from"./editor.5c4cb142.js";import{n as t,u as o}from"./index.5c4cb14.js";import"./options.5c4cb14.js";const r=t({name:"EditorReference",props:{token:{type:String,required:!0},coordinates:{type:Object,required:!0},content:{type:String,required:!0}},data:()=>({dropdownTrigger:null,markupContent:""}),async mounted(){this.monacoInstances=[],this.dropdownTrigger=this.coordinates,this.markupContent=e(this.content),await this.$nextTick(),this.attachMonaco()},methods:{attachMonaco(){const e=this.$refs.markdown.querySelectorAll("code");for(const t of e){const e=t.innerText.replace(/\n$/,""),o=e.split("\n");e.length>64?(t.classList.add("-monaco"),t.style.display="block",t.style.width="100%",t.style.minWidth="250px",t.style.height=18*o.length+"px",t.innerHTML="",this.monacoInstances.push(n.create(t,{value:e,language:"javascript",theme:"aggr",readOnly:!0,minimap:{enabled:!1},scrollbar:{alwaysConsumeMouseWheel:!1},automaticLayout:!1,wordBreak:"on",glyphMargin:!1,lineNumbers:"off",tabSize:2,contextmenu:!1,insertSpaces:!0,lineDecorationsWidth:4,renderLineHighlight:"none",scrollBeyondLastLine:!1,folding:!1,renderWhitespace:"none",overviewRulerBorder:!1,guides:{highlightActiveIndentation:!1,bracketPairsHorizontal:!1,indentation:!1}}))):t.classList.add("-filled")}},detachMonaco(){for(let e=0;e<this.monacoInstances.length;e++)this.monacoInstances[e].dispose(),this.monacoInstances.splice(e--,1)},beforeDestroy(){this.detachMonaco()},bindDragMove(e){if(2===e.button||this.dragging)return;document.addEventListener("mousemove",this.handleDragMove),document.addEventListener("mouseup",this.unbindDragMove),document.addEventListener("touchmove",this.handleDragMove),document.addEventListener("touchend",this.unbindDragMove);const{x:n,y:t}=o(e);this.dragging={x:n,y:t}},unbindDragMove(){this.dragging&&(document.removeEventListener("mousemove",this.handleDragMove),document.removeEventListener("mouseup",this.unbindDragMove),document.removeEventListener("touchmove",this.handleDragMove),document.removeEventListener("touchend",this.unbindDragMove),this.dragging=null)},handleDragMove(e){const{x:n,y:t}=o(e);this.$refs.dropdown.top+=t-this.dragging.y,this.$refs.dropdown.left+=n-this.dragging.x,this.dragging.x=n,this.dragging.y=t},onReferenceDropdownClose(){this.unbindDragMove(),this.detachMonaco()}}},(function(){var e=this,n=e._self._c;return n("dropdown",{ref:"dropdown",staticClass:"editor-reference__dropdown",attrs:{interactive:"",draggable:""},on:{closed:e.onReferenceDropdownClose},model:{value:e.dropdownTrigger,callback:function(n){e.dropdownTrigger=n},expression:"dropdownTrigger"}},[n("div",{staticClass:"editor-reference__header"},[n("div",{staticClass:"editor-reference__token",on:{mousedown:e.bindDragMove,touchstart:e.bindDragMove}},[e._v(" "+e._s(e.token)+" ")]),n("button",{staticClass:"editor-reference__close btn -text",on:{click:function(n){e.dropdownTrigger=null}}},[n("i",{staticClass:"icon-cross"})])]),n("div",{ref:"markdown",staticClass:"editor-reference__content marked",domProps:{innerHTML:e._s(e.markupContent)}})])}),[],!1,null,null,null,null).exports;export{r as default};
